{"version":3,"sources":["blocks.ts","App.styles.tsx","useShortcut.ts","useLocalStorage.ts","App.tsx","serviceWorker.ts","index.tsx"],"names":["moveBlocks","blocks","direction","size","newScore","newBlocks","rows","chunkSize","map","row","reverse","reduce","acc","concat","count","length","rowIndex","forEach","block","blockIndex","Array","toBlocks","arr","R","i","len","push","slice","n","el","toRows","score","splice","moveRow","newRow","randEl","Math","random","addRandom","nulls","index","eq","a","b","JSON","stringify","nextBlocks","d1","d2","d3","d4","isFailed","checkIfFail","fill","getColor","background","font","Container","Header","Title","Score","Info","Controls","Button","Body","props","Block","Failed","Footer","Link","useShortcut","keys","cbk","deps","action","callback","useCallback","useEffect","Mousetrap","bind","unbind","useLocalStorage","name","defaultValue","lsItem","localStorage","getItem","parse","useState","value","setValue","setItem","App","isEnd","setIsEnd","setScore","prevScore","setPrevScore","setBlocks","prevBlocks","setPrevBlocks","updateBlocks","swipeHandlers","useSwipeable","onSwipedLeft","onSwipedUp","onSwipedRight","onSwipedDown","back","onClick","window","confirm","disabled","bg","color","key","href","target","isLocalhost","Boolean","location","hostname","match","registerValidSW","swUrl","config","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","state","controller","console","log","onUpdate","onSuccess","catch","error","ReactDOM","render","StrictMode","document","getElementById","URL","process","origin","addEventListener","fetch","headers","response","contentType","get","status","indexOf","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.5ad50e1b.chunk.js","sourcesContent":["export type Direction = 0 | 1 | 2 | 3;\n\nfunction toRows(arr: number[], direction: Direction, chunkSize: number) {\n  var R = [];\n  if (direction === 0 || direction === 2) {\n    for (let i = 0, len = arr.length; i < len; i += chunkSize)\n      R.push(arr.slice(i, i + chunkSize));\n  } else {\n    for (let i = 0, len = arr.length; i < len; i++) {\n      let n = i % chunkSize;\n      if (R[n]) {\n        R[n].push(arr[i]);\n      } else {\n        R.push([arr[i]]);\n      }\n    }\n  }\n\n  if (direction > 1) {\n    R = R.map((el) => el.reverse());\n  }\n\n  return R;\n}\n\nfunction toBlocks(\n  rows: number[][],\n  direction: Direction,\n  chunkSize: number\n): number[] {\n  if (direction > 1) {\n    rows = rows.map((row) => row.reverse());\n  }\n\n  if (direction === 0 || direction === 2) {\n    return rows.reduce((acc, row) => acc.concat(row), []);\n  } else {\n    const count = rows.reduce((acc, row) => row.length + acc, 0);\n\n    return rows.reduce((acc, row, rowIndex) => {\n      row.forEach((block, blockIndex) => {\n        acc[blockIndex * chunkSize + rowIndex] = block;\n      });\n\n      return acc;\n    }, new Array(count));\n  }\n}\n\nfunction moveRow(row: number[]) {\n  let score = 0;\n  for (let i = 0; i < row.length; i++) {\n    if (row.slice(i).reduce((acc, block) => block === 0 && acc, true)) {\n      return { row, score };\n    }\n\n    if (row[i] === 0) {\n      row.splice(i, 1);\n      row.push(0);\n\n      if (i !== row.length - 1) {\n        i--;\n      }\n\n      continue;\n    }\n\n    if (i > 0 && row[i - 1] === row[i]) {\n      score += row[i] * 2;\n      row[i - 1] = row[i] * 2;\n      row.splice(i, 1);\n      row.push(0);\n\n      // i--;\n\n      // if (row[i] === row[i - 1]) {\n      //   i--;\n      // }\n\n      continue;\n    }\n  }\n\n  return { row, score };\n}\n\nconst moveBlocks = (blocks: number[], direction: Direction, size: number) => {\n  let newScore = 0;\n  let newBlocks = toBlocks(\n    toRows(blocks.slice(), direction, size).map((row) => {\n      const { row: newRow, score } = moveRow(row);\n      newScore += score;\n      return newRow;\n    }),\n    direction,\n    size\n  );\n\n  return { newBlocks, newScore };\n};\n\nconst randEl = <T>(arr: T[]) => arr[(arr.length * Math.random()) | 0];\n\nconst addRandom = (blocks: number[]) => {\n  const nulls = blocks.reduce(\n    (nulls, block, index) => (block === 0 ? [...nulls, index] : nulls),\n    new Array<number>()\n  );\n\n  blocks[randEl(nulls)] = randEl([2, 2, 2, 4]);\n\n  return blocks;\n};\n\nconst eq = <T>(a: T, b: T) => JSON.stringify(a) === JSON.stringify(b);\n\nconst checkIfFail = (blocks: number[], size: number) => {\n  const d1 = moveBlocks(blocks, 0, size),\n    d2 = moveBlocks(blocks, 1, size),\n    d3 = moveBlocks(blocks, 2, size),\n    d4 = moveBlocks(blocks, 3, size);\n\n  return {\n    newBlocks: blocks,\n    isFailed: eq(d1, d2) && eq(d2, d3) && eq(d3, d4),\n  };\n};\n\nexport const nextBlocks = (\n  blocks: number[],\n  direction: Direction,\n  size: number\n) => {\n  const { newBlocks, newScore } = moveBlocks(blocks, direction, size);\n\n  return { ...checkIfFail(addRandom(newBlocks), size), newScore };\n};\n\nexport const newBlocks = (size: number) =>\n  addRandom(new Array(size * size).fill(0));\n\nexport type BlockColor = {\n  font: string;\n  background: string;\n};\n\nexport const getColor = (block: number): BlockColor => {\n  switch (block) {\n    case 0:\n      return { background: \"#CDC0B4\", font: \"#CDC0B4\" };\n    case 2:\n      return { background: \"#EEE4DA\", font: \"#797066\" };\n    case 4:\n      return { background: \"#EFE3D1\", font: \"#797066\" };\n    case 8:\n      return { background: \"#F9B482\", font: \"#FAF7F4\" };\n    case 16:\n      return { background: \"#FB9569\", font: \"#FAF7F4\" };\n    case 32:\n      return { background: \"#FD7C64\", font: \"#FAF7F4\" };\n    case 64:\n      return { background: \"#F15A40\", font: \"#FAF7F4\" };\n    case 128:\n      return { background: \"#F5D873\", font: \"#FAF7F4\" };\n    case 256:\n      return { background: \"#F3D058\", font: \"#FAF7F4\" };\n    case 512:\n      return { background: \"#E6C03E\", font: \"#FAF7F4\" };\n    case 1024:\n      return { background: \"#E5BA32\", font: \"#FAF7F4\" };\n    case 2048:\n      return { background: \"#EFC42F\", font: \"#FAF7F4\" };\n    case 4096:\n      return { background: \"#BA84AA\", font: \"#FAF7F4\" };\n    default:\n      return { background: \"#AE60A4\", font: \"#FAF7F4\" };\n  }\n};\n","import { styled } from \"linaria/react\";\n\nexport const Container = styled.div`\n  width: 85vw;\n\n  @media (min-width: 768px) {\n    width: 768px;\n  }\n\n  margin: 0 auto;\n`;\n\nexport const Header = styled.header`\n  display: flex;\n  margin: 3.2em 0 2em 0;\n  padding: 0.2em 0.4em;\n`;\n\nexport const Title = styled.h1`\n  margin: 0;\n  font-size: 4em;\n  color: #797066;\n`;\n\nexport const Score = styled.div`\n  margin: 0 0 0 0.4em;\n  font-size: 1.2em;\n`;\n\nexport const Info = styled.nav`\n  margin: auto 0 auto auto;\n`;\n\nexport const Controls = styled.nav``;\n\nexport const Button = styled.button`\n  margin: 0 0 0.2em 0.4em;\n  padding: 0.24em 0.4em 0.2em 0.4em;\n\n  font-size: 1.4em;\n  background: #fd7c64;\n  color: #faf7f4;\n  border-radius: 0.4em;\n  border: none;\n`;\n\nexport const Body = styled.ul<{ disabled: boolean }>`\n  width: 80vw;\n  height: 80vw;\n\n  @media (min-width: 768px) {\n    width: 748px;\n    height: 748px;\n  }\n\n  pointer-events: ${(props) => (props.disabled ? \"none\" : \"all\")};\n  opacity: ${(props) => (props.disabled ? 0.4 : 1)};\n\n  margin: 0 auto;\n  padding: 0;\n\n  background: #bcada1;\n  border-radius: 0.4em;\n  padding: 0.32em;\n\n  display: grid;\n  grid-template-columns: repeat(4, 1fr);\n  grid-template-rows: repeat(4, 1fr);\n`;\n\nexport const Block = styled.li<{ size: string; bg: string; color: string }>`\n  margin: 0.32em;\n  padding: 0;\n\n  list-style: none;\n  border-radius: 0.4em;\n  overflow: hidden;\n  background: ${(props) => props.bg};\n\n  display: flex;\n\n  @media (min-width: 768px) {\n    border-radius: 0.8em;\n  }\n\n  span {\n    margin: auto;\n\n    font-size: ${(props) => props.size};\n    color: ${(props) => props.color};\n    font-weight: 680;\n  }\n`;\n\nexport const Failed = styled.div`\n  position: relative;\n  text-align: center;\n  top: 7.2em;\n  height: 0;\n\n  @media (min-width: 768px) {\n    font-size: 2.4em;\n  }\n\n  h1 {\n    margin: 0;\n    padding: 0;\n  }\n`;\n\nexport const Footer = styled.footer`\n  margin-top: 0.8em;\n`;\n\nexport const Link = styled.a`\n  text-decoration: none;\n  font-size: 1.2em;\n  margin: auto 0 auto 0.5em;\n  color: #797066;\n`;\n","import { useEffect, useCallback } from \"react\";\nimport Mousetrap from \"mousetrap\";\n\nexport default function useShortcut(\n  keys: string | string[],\n  cbk: (e: ExtendedKeyboardEvent, combo: string) => any,\n  deps?: any[],\n  action?: string\n) {\n  const callback = useCallback(cbk, deps || []);\n\n  useEffect(() => {\n    Mousetrap.bind(keys, callback, action);\n\n    return () => {\n      Mousetrap.unbind(keys);\n    };\n  }, [keys, callback, action]);\n}\n","import { useState, useEffect } from \"react\";\n\nfunction useLocalStorage<T>(\n  name: string,\n  defaultValue: T\n): [T, React.Dispatch<React.SetStateAction<T>>] {\n  let lsItem = localStorage.getItem(name);\n  if (lsItem !== null) {\n    defaultValue = JSON.parse(lsItem);\n  }\n\n  const [value, setValue] = useState<T>(defaultValue);\n\n  useEffect(() => {\n    localStorage.setItem(name, JSON.stringify(value));\n  }, [name, value]);\n\n  return [value, setValue];\n}\n\nexport default useLocalStorage;\n","import React from \"react\";\nimport { useSwipeable } from \"react-swipeable\";\n\nimport { nextBlocks, Direction, newBlocks, getColor } from \"./blocks\";\nimport {\n  Container,\n  Header,\n  Title,\n  Score,\n  Info,\n  Controls,\n  Button,\n  Failed,\n  Body,\n  Block,\n  Footer,\n  Link,\n} from \"./App.styles\";\nimport useShortcut from \"./useShortcut\";\nimport useLocalStorage from \"./useLocalStorage\";\n\nfunction App() {\n  const size = 4;\n  const [isEnd, setIsEnd] = useLocalStorage(\"is-end\", false);\n  const [score, setScore] = useLocalStorage(\"score\", 0);\n  const [prevScore, setPrevScore] = useLocalStorage(\"score-back\", score);\n  const [blocks, setBlocks] = useLocalStorage(\"blocks\", newBlocks(size));\n  const [prevBlocks, setPrevBlocks] = useLocalStorage(\"blocks-back\", blocks);\n\n  const updateBlocks = (direction: Direction) => () =>\n    !isEnd &&\n    setBlocks((blocks) => {\n      const { newBlocks, isFailed, newScore } = nextBlocks(\n        blocks,\n        direction,\n        size\n      );\n\n      setIsEnd(isFailed);\n      setPrevBlocks(blocks);\n      setScore((score) => {\n        setPrevScore(score);\n        return score + newScore;\n      });\n\n      return newBlocks;\n    });\n\n  const swipeHandlers = useSwipeable({\n    onSwipedLeft: updateBlocks(0),\n    onSwipedUp: updateBlocks(1),\n    onSwipedRight: updateBlocks(2),\n    onSwipedDown: updateBlocks(3),\n  });\n\n  useShortcut(\"left\", updateBlocks(0));\n  useShortcut(\"up\", updateBlocks(1));\n  useShortcut(\"right\", updateBlocks(2));\n  useShortcut(\"down\", updateBlocks(3));\n\n  const reset = () => {\n    if (!window.confirm(\"Are you sure?\")) return;\n    setBlocks(newBlocks(size));\n    setIsEnd(false);\n  };\n\n  const back = () => {\n    setIsEnd(false);\n    setBlocks(prevBlocks);\n    setScore(prevScore);\n  };\n\n  useShortcut(\"ctrl+z\", back, [back]);\n\n  return (\n    <Container>\n      <Header>\n        <Title>2048</Title>\n\n        <Info>\n          <Controls>\n            <Button onClick={back}>Back</Button>\n            <Button onClick={reset}>Reset</Button>\n          </Controls>\n          <Score>Score: {score}</Score>\n        </Info>\n      </Header>\n      {isEnd && (\n        <Failed>\n          <h1>That's all, folks!</h1>\n        </Failed>\n      )}\n      <Body disabled={isEnd} {...swipeHandlers}>\n        {blocks.map((block, index) => (\n          <Block\n            bg={getColor(block).background}\n            color={getColor(block).font}\n            size={block > 512 ? (block > 16000 ? \"1.4em\" : \"1.6em\") : \"2em\"}\n            key={`${block}-${index}`}\n          >\n            <span>{block}</span>\n          </Block>\n        ))}\n      </Body>\n      <Footer>\n        <Link href=\"https://github.com/noartem\" target=\"_blank\">\n          @noartem\n        </Link>\n      </Footer>{\" \"}\n    </Container>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.register();\n"],"sourceRoot":""}